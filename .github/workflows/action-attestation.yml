name: Attestation Action

on:
    workflow_dispatch: 


permissions:
      contents: read
      packages: write
      id-token: write 
      attestations: write


jobs:
    build:
        runs-on: ubuntu-latest
        steps:
            - name: Check out directory
              uses: actions/checkout@v4
            - uses: actions/attest-build-provenance@v1
              id: attest
              with:
                subject-path: README.md

            - uses: actions/upload-artifact@v4
              with:
                name: Build Artifacts
                path: | 
                  README.md
                  ${{ steps.attest.outputs.bundle-path }}

            - run: echo cosign verify-blob cosign-experiment/cosign-experiment/README.md --bundle _temp/V4iaWO/attestation.jsonl --new-bundle-format --cert-oidc-issuer https://token.actions.githubusercontent.com --cert-identity https://github.com/${GITHUB_WORKFLOW_REF}